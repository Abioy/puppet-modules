#!/bin/bash
# <%= description %>
# Script generated by Puppet. It's executed when you run:
# puppi info <%= name %> 
#
# Sources common header for Puppi scripts
. <%= scope.lookupvar('puppi::params::scriptsdir') %>/header || exit 10

<% if packagename != "" %>
# Show packages info
echo_title "Packages Installed: <% packagename.split("###").each do |item| %><%= item %><% end %>"
<% packagename.split("###").each do |item| %>
show_command "<%= scope.lookupvar('puppi::params::info_package_query') %> <%= item %>"
show_command "<%= scope.lookupvar('puppi::params::info_package_list') %> <%= item %> | egrep '(/bin|^/etc|/sbin|log)'"
<% end %>
<% end %>

<% if servicename != "" %>
# Show service info
echo_title "Service managed: <% servicename.split("###").each do |item| %><%= item %><% end %>"
<% servicename.split("###").each do |item| %>
show_command "/etc/init.d/<%= item %> status"
<% end %>

show_command "ps -adef | grep <%= processname %>"
show_command "netstat -natup | grep ':<%= port %> '"
<% end %>

<% if configfile != "" %>
# Show config info
echo_title "Configuration Files managed: <% configfile.split("###").each do |item| %><%= item %><% end %>"
<% configfile.split("###").each do |item| %>
show_command "stat <%= item %>"
<% end %>
<% end %>

<% if datadir != "" %>
# Show data dir
echo_title "Application data are in: <% datadir.split("###").each do |item| %><%= item %><% end %>"
<% datadir.split("###").each do |item| %>
show_command "ls -latr <%= item %>"
show_command "df <%= item %>"
<% end %>
<% end %>

<% if run != "" %>
echo_title "Extra info"
<% run.split("###").each do |cmd| %>show_command "<%= cmd %>"
<% end %>
<% end %>
